"use strict";function drawChart(t,e,o,n,a){var i={hAxis:{format:"HH:mm"},colors:e,legend:{position:"none"},height:a,backgroundColor:"#FAFAFA",title:o,animation:{duration:1e3,easing:"in"},isStacked:!1};t.draw(n,i)}function PhotosController(t,e,o){t.station=e.station,t.hide=function(){o.hide()},t.cancel=function(){o.cancel()},t.answer=function(t){o.hide(t)}}function InfoController(t,e,o){t.station=e.station,t.hide=function(){o.hide()},t.cancel=function(){o.cancel()},t.answer=function(t){o.hide(t)}}PhotosController.$inject=["$scope","$rootScope","$mdDialog"],InfoController.$inject=["$scope","$rootScope","$mdDialog"],function(){angular.module("angulike",[]).directive("fbLike",["$window","$rootScope",function(t,e){return{restrict:"A",scope:{fbLike:"=?"},link:function(e,o,n){function a(){if(!n.fbLike||e.fbLike||i)o.html('<div class="fb-like"'+(e.fbLike?' data-href="'+e.fbLike+'"':"")+' data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>'),t.FB.XFBML.parse(o.parent()[0]);else{i=!0;var r=e.$watch("fbLike",function(t,e){t&&(a(),r())})}}t.FB?a():$.getScript("//connect.facebook.net/en_US/sdk.js",function(){t.FB.init({appId:742272115829511,xfbml:!0,version:"v2.0"}),a()});var i=!1}}}]).directive("googlePlus",["$window",function(t){return{restrict:"A",scope:{googlePlus:"=?"},link:function(e,o,n){function a(){if(!n.googlePlus||e.googlePlus||i)o.html('<div class="g-plusone"'+(e.googlePlus?' data-href="'+e.googlePlus+'"':"")+' data-size="medium"></div>'),t.gapi.plusone.go(o.parent()[0]);else{i=!0;var r=e.$watch("googlePlus",function(t,e){t&&(a(),r())})}}t.gapi?a():$.getScript("//apis.google.com/js/platform.js",function(){a()});var i=!1}}}]).directive("tweet",["$window","$location",function(t,e){return{restrict:"A",scope:{tweet:"=",tweetUrl:"="},link:function(o,n,a){function i(){if(o.tweet||r)n.html('<a href="https://twitter.com/share" class="twitter-share-button" data-text="'+o.tweet+'" data-url="'+(o.tweetUrl||e.absUrl())+'">Tweet</a>'),t.twttr.widgets.load(n.parent()[0]);else{r=!0;var a=o.$watch("tweet",function(t,e){t&&(i(),a())})}}t.twttr?i():$.getScript("//platform.twitter.com/widgets.js",function(){i()});var r=!1}}}]).directive("pinIt",["$window","$location",function(t,e){return{restrict:"A",scope:{pinIt:"=",pinItImage:"=",pinItUrl:"="},link:function(o,n,a){function i(){if(o.pinIt||r)n.html('<a href="//www.pinterest.com/pin/create/button/?url='+(o.pinItUrl||e.absUrl())+"&media="+o.pinItImage+"&description="+o.pinIt+'" data-pin-do="buttonPin" data-pin-config="beside"></a>'),t.parsePins(n.parent()[0]);else{r=!0;var a=o.$watch("pinIt",function(t,e){t&&(i(),a())})}}t.parsePins?i():!function(e){var o=e.getElementsByTagName("SCRIPT")[0],n=e.createElement("SCRIPT");n.type="text/javascript",n.async=!0,n.src="//assets.pinterest.com/js/pinit.js",n["data-pin-build"]="parsePins",n.onload=function(){t.parsePins?i():setTimeout(n.onload,100)},o.parentNode.insertBefore(n,o)}(t.document);var r=!1}}}])}();var pluviamApp=angular.module("pluviamApp",["ngRoute","ngMaterial","angulike"]);pluviamApp.config(["$mdThemingProvider",function(t){t.theme("default").primaryPalette("blue").accentPalette("indigo")}]),pluviamApp.config(["$compileProvider",function(t){t.debugInfoEnabled(!1)}]),pluviamApp.config(["$routeProvider","$locationProvider",function(t,e){t.when("/",{templateUrl:"home.html",controller:"mainController"}).when("/about",{templateUrl:"about.html",controller:"aboutController"}).when("/:country/:county/:city/:stationName",{templateUrl:"stations.html",controller:"StationsController"}).otherwise({redirectTo:"/"}),e.html5Mode(!0)}]),pluviamApp.controller("mainController",["$scope",function(t){t.message="main!"}]),pluviamApp.controller("aboutController",["$scope",function(t){t.message="Nada aqui, ainda"}]),pluviamApp.controller("StationsController",["$scope","$rootScope","$http","$routeParams","$mdDialog","$mdMedia","$interval",function(t,e,o,n,a,i,r){function l(){console.log("api called"),o.get(c+"/stations/").success(function(n,a,r,l){angular.forEach(n.stations,function(n,a){u===n.location.countryCode.toLowerCase()&&d===n.location.countyCode.toLowerCase()&&m===n.location.urlCity.toLowerCase()&&f===n.urlName.toLowerCase()&&(s=n.id,o.get(c+"/stations/"+s).success(function(o,n,a,r){t.weather=o.weather[o.weather.length-1],t.station=o.station,e.station=o.station,e.seo={pageTitle:"pluviam - "+o.station.fullName,canonicalUrl:"http://pluvi.am/"+o.station.location.countryCode.toLowerCase()+"/"+o.station.location.countyCode.toLowerCase()+"/"+o.station.location.urlCity+"/"+o.station.urlName,name:o.station.fullName+" - Estação meteorológica Pluviam"};var l=document.getElementById("indeterminateLoader"),c=document.getElementById("graphsBase");angular.forEach(o.station.inputs,function(e,n){if("none"!==e.chartType){var a=e.name,r=!1,l="";if(""!==e.plotTogether&&(r=e.plotTogether,angular.forEach(o.station.inputs,function(t,e){t.name===r&&(l=t)})),c.insertAdjacentHTML("beforebegin",'<div flex id="'+a+'"></div>'),p[a]=new google.visualization.DataTable,p[a].addColumn("datetime","Data/Hora"),p[a].addColumn("number",e.shortName),r&&p[a].addColumn("number",l.shortName),r)angular.forEach(o.weather,function(t,e){p[a].addRow([new Date(t.date),parseFloat(t[a]),t[l.name]])});else if(e.cumulative){var s,u,d=0,m=o.weather[o.weather.length-1].date,f=new Date(m).getDate();angular.forEach(o.weather,function(t,e){u=new Date(t.date).getDate(),s=t[a],p[a].addRow([new Date(t.date),s]),u===f&&(d+=s)}),t.weather[a]=parseFloat(d.toFixed(1))}else angular.forEach(o.weather,function(t,e){p[a].addRow([new Date(t.date),t[a]])});if(g){var w=i("sm")||i("xs")?250:400;"LineChart"===e.chartType?h[a]=new google.visualization.LineChart(document.getElementById(a)):"ColumnChart"===e.chartType?h[a]=new google.visualization.ColumnChart(document.getElementById(a)):"AreaChart"===e.chartType&&(h[a]=new google.visualization.AreaChart(document.getElementById(a))),drawChart(h[a],e.chartColors,e.shortName+" - "+e.unit,p[a],w)}else drawChart(h[a],e.chartColors,e.shortName+" - "+e.unit,p[a],w)}}),l.style.display="none",g=!1}).error(function(t,e,o,n){console.log("fail")}))})}).error(function(t,e,o,n){console.log("fail")})}var c="//api.pluvi.am",s="",u=n.country.toLowerCase(),d=n.county.toLowerCase(),m=n.city.toLowerCase(),f=n.stationName.toLowerCase(),p=[],h=[],g=!0;l(),r(l,3e5),t.showPhotos=function(e){var o=(i("sm")||i("xs"))&&t.customFullscreen;a.show({controller:PhotosController,templateUrl:"photos.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:o}).then(function(e){t.status='You said the information was "'+e+'".'},function(){t.status="You cancelled the dialog."}),t.$watch(function(){return i("xs")||i("sm")},function(e){t.customFullscreen=!0})},t.showInfos=function(e){var o=(i("sm")||i("xs"))&&t.customFullscreen;a.show({controller:InfoController,templateUrl:"infos.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:o}).then(function(e){t.status='You said the information was "'+e+'".'},function(){t.status="You cancelled the dialog."}),t.$watch(function(){return i("xs")||i("sm")},function(e){t.customFullscreen=!0})}}]);